{% extends 'base.html' %}

{% block title %}Set New Password - CEMS{% endblock %}
{% block body_class %}no-topbar{% endblock %}
{% block topbar %}{% endblock %}
{% block sidebar %}{% endblock %}
{% block layout_class %}auth-only{% endblock %}

{% block content %}
<section class="auth-single">
    <div class="card auth-card">
        <div class="card-header">
            <span>Set a new password</span>
            <div class="chip">Reset</div>
        </div>

        {% if validlink %}
            <form class="form" method="post" action="">
                {% csrf_token %}

                {% if form.non_field_errors %}
                    <p style="color:red; font-size:14px; margin-bottom:8px;">
                        {{ form.non_field_errors|join:", " }}
                    </p>
                {% endif %}

                <label>New password</label>
                {{ form.new_password1 }}
                {% if form.new_password1.errors %}
                    <p style="color:red; font-size:13px; margin:6px 0 0 0;">
                        {{ form.new_password1.errors|join:", " }}
                    </p>
                {% endif %}

                <label>Confirm password</label>
                {{ form.new_password2 }}
                {% if form.new_password2.errors %}
                    <p style="color:red; font-size:13px; margin:6px 0 0 0;">
                        {{ form.new_password2.errors|join:", " }}
                    </p>
                {% endif %}

                <div class="form-footer">
                    <button class="btn primary full" type="submit">Save new password</button>
                    <a class="link-btn" href="{% url 'accounts:login' %}">Back to login</a>
                </div>
            </form>
        {% else %}
            <p class="helper muted-line">
                This reset link is invalid or has expired. Please request a new link.
            </p>
            <div class="form-footer">
                <a class="btn primary full" href="{% url 'accounts:password_reset' %}">
                    Request new reset link
                </a>
            </div>
        {% endif %}
    </div>
    <a class="btn return-btn" href="/">Back to home</a>
</section>
{% endblock %}
